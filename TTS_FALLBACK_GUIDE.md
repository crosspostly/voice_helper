# üé§Ô∏è –í–∞—Ä–∏–∞–Ω—Ç 2: –ì–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º (–ì–æ–ª–æ—Å –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫ + Fallback)

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

**–ü—Ä–æ–±–ª–µ–º–∞:**  
–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π Gemini API –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 15 TTS –∑–∞–ø—Ä–æ—Å–∞–º–∏ –≤ –¥–µ–Ω—å. –ü–æ—Å–ª–µ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –ª–∏–º–∏—Ç–∞ –≥–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç –æ—Ç–≤–µ—á–∞—Ç—å –≥–æ–ª–æ—Å–æ–º.

**–†–µ—à–µ–Ω–∏–µ:**  
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–¥–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≥–æ–ª–æ—Å–∞**:
1. **–û—Å–Ω–æ–≤–Ω–æ–π:** Gemini TTS (–≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≥–æ–ª–æ—Å)
2. **–ó–∞–ø–∞—Å–Ω–æ–π:** –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–π Web Speech API (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –±–µ–∑ –ª–∏–º–∏—Ç–æ–≤)

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç
      ‚Üì
Gemini Live API (–≥–æ–ª–æ—Å ‚Üí —Ç–µ–∫—Å—Ç)
      ‚Üì
Gemini 2.5 Flash (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞)
      ‚Üì
   ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
   ‚ïë –ü–æ–ø—ã—Ç–∫–∞ Gemini TTS        ‚ïë
   ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
   ‚ïë ‚úÖ –£—Å–ø–µ—Ö ‚Üí –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏  ‚ïë
   ‚ïë ‚ùå Quota ‚Üí Browser TTS    ‚ïë
   ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
      ‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ª—ã—à–∏—Ç –æ—Ç–≤–µ—Ç (–ë–ï–ó –ó–ê–î–ï–†–ñ–ï–ö!)
```

---

## –ü–æ—á–µ–º—É –Ω–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫?

### –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ (Live API):

```typescript
// 1. –ú–∏–∫—Ä–æ—Ñ–æ–Ω ‚Üí Gemini Live API (—Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è)
stream ‚Üí WebSocket ‚Üí Gemini Server

// 2. Gemini —Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç –≥–æ–ª–æ—Å–æ–º
Gemini ‚Üí Audio chunks ‚Üí –ë—Ä–∞—É–∑–µ—Ä

// 3. –ê—É–¥–∏–æ —á–∞–Ω–∫–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏
playAudio(chunk1) ‚Üí –∏–≥—Ä–∞–µ—Ç
playAudio(chunk2) ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å
playAudio(chunk3) ‚Üí ...
```

**–ó–∞–¥–µ—Ä–∂–∫–∞:** ~200-500 –º—Å (–≤—Ä–µ–º—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ –æ–±–ª–∞–∫–µ)

### –í –≤–∞—Ä–∏–∞–Ω—Ç–µ 2 (—Å fallback):

```typescript
// –í–°–Å –¢–û –ñ–ï –°–ê–ú–û–ï, –Ω–æ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π:

try {
  // Gemini TTS (–±—ã—Å—Ç—Ä–æ, ~200-500 –º—Å)
  const audioChunk = await gemini.tts(text);
  playAudio(audioChunk); // ‚Üê –ì–æ–ª–æ—Å Gemini
} catch (quotaError) {
  // –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–π TTS (—Ç–æ–∂–µ –±—ã—Å—Ç—Ä–æ, ~100-300 –º—Å)
  speechSynthesis.speak(utterance); // ‚Üê –ì–æ–ª–æ—Å –±—Ä–∞—É–∑–µ—Ä–∞
}
```

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–π TTS **–ù–ï –ú–ï–î–õ–ï–ù–ù–ï–ï** Gemini TTS!  
–û–±–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ—á—Ç–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Gemini TTS | Browser TTS |
|----------|------------|-------------|
| **–ö–∞—á–µ—Å—Ç–≤–æ** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –û—á–µ–Ω—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π | ‚≠ê‚≠ê‚≠ê –†–æ–±–æ—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π |
| **–ó–∞–¥–µ—Ä–∂–∫–∞** | ~200-500 –º—Å | ~100-300 –º—Å |
| **–õ–∏–º–∏—Ç—ã** | 15/–¥–µ–Ω—å (–±–µ—Å–ø–ª–∞—Ç–Ω–æ) | ‚ôæÔ∏è Unlimited |
| **–ì–æ–ª–æ—Å–∞** | 5 (Zephyr, Puck, Charon, Kore, Fenrir) | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –û–° |
| **–≠–º–æ—Ü–∏–∏** | ‚úÖ –ï—Å—Ç—å | ‚ùå –ù–µ—Ç |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —è–∑—ã–∫–æ–≤** | 40+ | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –±—Ä–∞—É–∑–µ—Ä–∞ |

---

## –ö–∞–∫ —ç—Ç–æ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤—ã–µ 15 —Å–æ–æ–±—â–µ–Ω–∏–π (–µ—Å—Ç—å –∫–≤–æ—Ç–∞ Gemini)

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ü—Ä–∏–≤–µ—Ç!"
  ‚Üì [200 –º—Å –∑–∞–¥–µ—Ä–∂–∫–∞]
Gemini (–≥–æ–ª–æ—Å Zephyr): "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?"
```

**–ö–∞—á–µ—Å—Ç–≤–æ:** 5/5 ‚≠ê  
**–ó–∞–¥–µ—Ä–∂–∫–∞:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ—Å–ª–µ 15 —Å–æ–æ–±—â–µ–Ω–∏–π (–∫–≤–æ—Ç–∞ –∏—Å—á–µ—Ä–ø–∞–Ω–∞)

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ö–∞–∫ –¥–µ–ª–∞?"
  ‚Üì [150 –º—Å –∑–∞–¥–µ—Ä–∂–∫–∞]
–ë—Ä–∞—É–∑–µ—Ä (—Å–∏—Å—Ç–µ–º–Ω—ã–π –≥–æ–ª–æ—Å): "–£ –º–µ–Ω—è –≤—Å—ë —Ö–æ—Ä–æ—à–æ, —Å–ø–∞—Å–∏–±–æ!"
```

**–ö–∞—á–µ—Å—Ç–≤–æ:** 3/5 ‚≠ê (–±–æ–ª–µ–µ —Ä–æ–±–æ—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)  
**–ó–∞–¥–µ—Ä–∂–∫–∞:** –î–∞–∂–µ –ú–ï–ù–¨–®–ï, —á–µ–º —É Gemini!

---

## Live API (–≥–æ–ª–æ—Å-–≤-–≥–æ–ª–æ—Å) ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

–í –≤–∞—à–µ–º —Ç–µ–∫—É—â–µ–º —Ä–µ–∂–∏–º–µ (`useLiveSession.ts`) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Gemini Live API**:

```typescript
// –≠—Ç–æ –ù–ï —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º! –≠—Ç–æ live audio streaming
sessionPromiseRef.current = ai.live.connect({
  model: 'gemini-2.5-flash-native-audio-preview-09-2025',
  // ...
});
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Live API:**

1. **–ú–∏–∫—Ä–æ—Ñ–æ–Ω ‚Üí —Å–µ—Ä–≤–µ—Ä (WebSocket, realtime)**
   ```
   –ö–∞–∂–¥—ã–µ 20 –º—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞—É–¥–∏–æ —á–∞–Ω–∫
   ```

2. **–°–µ—Ä–≤–µ—Ä —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Ä–µ—á—å –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–û**
   ```
   Gemini –Ω–∞—á–∏–Ω–∞–µ—Ç –≥–æ–≤–æ—Ä–∏—Ç—å –µ—â—ë –î–û —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏ —Ñ—Ä–∞–∑—É
   (–Ω–æ –∂–¥—ë—Ç –ø–∞—É–∑—É –±–ª–∞–≥–æ–¥–∞—Ä—è TURN_TAKING_INSTRUCTION)
   ```

3. **–û—Ç–≤–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç —Ç–æ–∂–µ —á–∞–Ω–∫–∞–º–∏**
   ```typescript
   onmessage: (message) => {
     const audioChunk = message.serverContent?.modelTurn?.parts?.[0]?.inlineData?.data;
     if (audioChunk) {
       playAudio(audioChunk); // ‚Üê –°—Ä–∞–∑—É –∏–≥—Ä–∞–µ—Ç
     }
   }
   ```

**–í Live API TTS —É–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω!**  
–í–∞–º **–ù–ï –ù–£–ñ–ï–ù** fallback –¥–ª—è Live —Ä–µ–∂–∏–º–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ:
- Live API –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≥–æ–ª–æ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –£ –Ω–µ–≥–æ **–¥—Ä—É–≥–æ–π –ª–∏–º–∏—Ç** (1,000,000 —Ç–æ–∫–µ–Ω–æ–≤/–º–∏–Ω—É—Ç—É)
- TTS –ª–∏–º–∏—Ç (15/–¥–µ–Ω—å) –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –∫ –æ—Ç–¥–µ–ª—å–Ω–æ–º—É TTS endpoint

---

## –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –í–∞—Ä–∏–∞–Ω—Ç 2?

### ‚úÖ –ù—É–∂–µ–Ω –¥–ª—è:
- **–¢–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞** (–∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞)
- **–ü—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞** (replay —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π)
- **Offline —Ä–µ–∂–∏–º–∞** (–µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä Gemini –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)

### ‚ùå –ù–ï –Ω—É–∂–µ–Ω –¥–ª—è:
- **Live –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞** (—É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ, –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ!)
- –ú–∏–∫—Ä–æ—Ñ–æ–Ω ‚Üí Gemini ‚Üí –ì–æ–ª–æ—Å —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Live API –±–µ–∑ TTS endpoint

---

## –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ (–ù–ï –¢–†–û–ì–ê–¢–¨):

```typescript
// hooks/useLiveSession.ts ‚Äî Live —Ä–µ–∂–∏–º
startSession() ‚Üí {
  // –ú–∏–∫—Ä–æ—Ñ–æ–Ω
  getUserMedia({ audio: { echoCancellation: true } })
  
  // Gemini Live API (–≥–æ–ª–æ—Å-–≤-–≥–æ–ª–æ—Å)
  ai.live.connect({
    model: 'gemini-2.5-flash-native-audio-preview-09-2025',
    responseModalities: [Modality.AUDIO], // ‚Üê –°—Ä–∞–∑—É –≥–æ–ª–æ—Å
  })
}

// –û—Ç–≤–µ—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç —É–∂–µ –≤ –∞—É–¥–∏–æ —Ñ–æ—Ä–º–∞—Ç–µ, –±–µ–∑ TTS –ª–∏–º–∏—Ç–æ–≤!
```

**–ó–∞–¥–µ—Ä–∂–∫–∞:** ~200-500 –º—Å  
**–ö–∞—á–µ—Å—Ç–≤–æ:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê  
**–õ–∏–º–∏—Ç—ã:** 1M —Ç–æ–∫–µ–Ω–æ–≤/–º–∏–Ω—É—Ç—É (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑–ª–∏–º–∏—Ç –¥–ª—è –≥–æ–ª–æ—Å–∞)

### –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å (–í–∞—Ä–∏–∞–Ω—Ç 2):

```typescript
// App.tsx ‚Äî –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
sendTextMessage() ‚Üí {
  // –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ü–ï–ß–ê–¢–ê–ï–¢ —Ç–µ–∫—Å—Ç
  const response = await chat.sendMessage(text);
  
  // –ü–æ–ø—ã—Ç–∫–∞ Gemini TTS
  try {
    await playText(response.text);
  } catch (quotaError) {
    // Fallback –Ω–∞ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π TTS
    speechSynthesis.speak(response.text);
  }
}
```

**–ó–∞–¥–µ—Ä–∂–∫–∞:** ~100-500 –º—Å  
**–ö–∞—á–µ—Å—Ç–≤–æ:** ‚≠ê‚≠ê‚≠ê-‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–≤–æ—Ç—ã)  
**–õ–∏–º–∏—Ç—ã:** 15 TTS/–¥–µ–Ω—å ‚Üí –ø–æ—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π TTS (–±–µ–∑–ª–∏–º–∏—Ç)

---

## –í—ã–≤–æ–¥

**–í–∞—à —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º (Live API):**
- ‚úÖ –£–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≥–æ–ª–æ—Å-–≤-–≥–æ–ª–æ—Å –ë–ï–ó –∑–∞–¥–µ—Ä–∂–µ–∫
- ‚úÖ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TTS endpoint (–Ω–µ —É–ø–∏—Ä–∞–µ—Ç—Å—è –≤ 15/–¥–µ–Ω—å)
- ‚úÖ –õ–∏–º–∏—Ç: 1M —Ç–æ–∫–µ–Ω–æ–≤/–º–∏–Ω—É—Ç—É (–æ–≥—Ä–æ–º–Ω—ã–π)

**–í–∞—Ä–∏–∞–Ω—Ç 2 (Fallback TTS):**
- ‚úÖ –ü–æ–ª–µ–∑–µ–Ω –¥–ª—è –¢–ï–ö–°–¢–û–í–û–ì–û —Ä–µ–∂–∏–º–∞ (–∫–æ–≥–¥–∞ –ø–µ—á–∞—Ç–∞—é—Ç, –∞ –Ω–µ –≥–æ–≤–æ—Ä—è—Ç)
- ‚úÖ –î–∞—ë—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–ø–æ—Å–ª–µ –∫–≤–æ—Ç—ã ‚Üí –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –≥–æ–ª–æ—Å)
- ‚ö†Ô∏è –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–π –≥–æ–ª–æ—Å —á—É—Ç—å —Ö—É–∂–µ –∫–∞—á–µ—Å—Ç–≤–æ–º, –Ω–æ –ë–ï–ó –∑–∞–¥–µ—Ä–∂–µ–∫

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**  
–û—Å—Ç–∞–≤—å—Ç–µ Live —Ä–µ–∂–∏–º –∫–∞–∫ –µ—Å—Ç—å (–æ–Ω –∏–¥–µ–∞–ª–µ–Ω!), –∞ –í–∞—Ä–∏–∞–Ω—Ç 2 –¥–æ–±–∞–≤—å—Ç–µ –∫–∞–∫ **–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Ñ–∏—á—É** –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞.

---

## –ö–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –í–∞—Ä–∏–∞–Ω—Ç–∞ 2

### –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª: `hooks/useTTSFallback.ts`

```typescript
import { useCallback } from 'react';

export const useTTSFallback = (
  lang: 'en' | 'ru',
  speakingRate: string,
  pitch: string,
  log: (msg: string, level?: 'INFO' | 'ERROR' | 'DEBUG') => void
) => {
  
  const speakWithBrowserTTS = useCallback((text: string): Promise<void> => {
    return new Promise((resolve, reject) => {
      if (!window.speechSynthesis) {
        reject(new Error('Browser TTS not supported'));
        return;
      }

      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = lang === 'ru' ? 'ru-RU' : 'en-US';
      utterance.rate = parseFloat(speakingRate) || 1.0;
      utterance.pitch = (parseFloat(pitch) / 10) + 1.0; // 0-2 range

      utterance.onend = () => {
        log('Browser TTS finished.', 'INFO');
        resolve();
      };

      utterance.onerror = (e) => {
        log(`Browser TTS error: ${e.error}`, 'ERROR');
        reject(new Error(e.error));
      };

      log(`Speaking with browser TTS (${utterance.lang}).`, 'INFO');
      window.speechSynthesis.speak(utterance);
    });
  }, [lang, speakingRate, pitch, log]);

  return { speakWithBrowserTTS };
};
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ `App.tsx`:

```typescript
import { useTTSFallback } from './hooks/useTTSFallback';

// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ App:
const { speakWithBrowserTTS } = useTTSFallback(lang, speakingRate, pitch, log);

// –í —Ñ—É–Ω–∫—Ü–∏–∏ playText (–¥–æ–±–∞–≤–∏—Ç—å catch):
const playText = async (text: string) => {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ Gemini TTS ...
  
  try {
    const response = await ai.models.generateContent({...});
    const base64Audio = response.candidates?.[0]?.content?.parts?.[0]?.inlineData?.data;
    
    if (base64Audio) {
      await playAudio(base64Audio);
    } else {
      throw new Error('No audio in response');
    }
  } catch (error: any) {
    const quotaErrors = ['quota', '429', 'rate limit'];
    if (quotaErrors.some(err => error.message?.toLowerCase().includes(err))) {
      log('Gemini TTS quota exceeded. Using browser TTS.', 'INFO');
      await speakWithBrowserTTS(text);
    } else {
      throw error; // Re-throw non-quota errors
    }
  }
};
```

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –∫–≤–æ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –≥–æ–ª–æ—Å –ë–ï–ó –∑–∞–¥–µ—Ä–∂–µ–∫! üéâ